<!doctype html>

<title>Camera json</title>

<style type="text/css">

body {
  margin: 40px 10%;
  font-family: Helvetica, sans-serif;
  background-color: #fff;
  color: #444;
  font-size: 20px;
}
h1, h2, h3, label, td{
}
a{
  color: #AE4A4C;
  text-decoration: none;
}
.wrapper {
  margin: 0 20px;
  display: grid;
  grid-gap: 0px;
}

@media screen and (min-width: 500px) {

  .wrapper {
    margin: 0 auto;
    grid-template-columns: repeat(2, 1fr);
  }
  
  .header, .footer {
    grid-column: 1 / -1;
    /* needed for the floated layout */
    clear: both;
  }

}

.wrapper > * {
  padding: 20px;
  /* needed for the floated layout*/
  margin-bottom: 10px;
}
form{
  background-color: #e4e1f0;
}
textarea{
  width: 100%;
}
pre{
  overflow: auto;
  background-color: #edefee;
  padding: 5px;
}
td{
  vertical-align: top;
  border-top: 1px solid #ccc;
  padding: 8px 20px 8px 0;
  font-size: 16px;
}
img{
  width: 100%;
}
.intro{
  background-color: #F7F7F6;
}
.smaller{
  font-size: 0.7em;
}


</style>



<div class="header">
  <h1>Blikveld2BAG</h1>
</div>

<div class="wrapper">
  <div class="intro">
    <p>
      De Blikveld2BAG API geeft de panden (en adressen) terug die binnen een blikveld vallen. Voor de New York Public Library maakte Bert Spaan eerder een <a href="http://spacetime.nypl.org/Leaflet.GeotagPhoto/examples/camera.html">tooltje om zo'n blikveld mee te tekenen</a>. De output van dat tooltje dient als de input voor deze api.
    </p>
    <p>
      De API geeft alleen de panden terug die daadwerkelijk in zicht staan, panden die achter andere panden staan worden niet teruggegeven.
    </p>
    <p>
      Bouwjaren worden meegegeven, zodat je desgewenst rekening kunt houden met het moment waarop een foto is genomen.
    </p>
    <p>
      Onder het kopje <a href="#hoehetwerkt">Hoe het werkt</a> meer over ... hoe het werkt.
    </p>
  </div>
  <div class="intro">
    <img src="https://github.com/rduivenvoorde/blikveld/blob/master/imgs/blikveld2bag.png?raw=true" />
    <p class="smaller">
      Code door <a href="http://zuidt.nl/">Richard Duivenvoorde</a>, mentaal terzijde gestaan door <a href="http://islandsofmeaning.nl/">Menno den Engelse</a>, mede mogelijk gemaakt door een financiÃ«le bijdrage van het <a href="https://noord-hollandsarchief.nl/">Noord-Hollands Archief</a>, code op <a href="https://github.com/rduivenvoorde/blikveld">GitHub</a>. 
    </p>
  </div> 
</div>


<h2>Parameters</h2>
<table>
  <tr>
    <td>
      <strong>camera_json</strong>
    </td>
    <td>
      camera_json=[urlencoded geojson]
    </td>
    <td>
      De geojson moet een GeometryCollection bevatten met een punt (het camerastandpunt) en een lijn (de tegenovergelegen zijde waarmee het blikveld wordt uitgedrukt), zoals het <a href="http://spacetime.nypl.org/Leaflet.GeotagPhoto/examples/camera.html">NYPL tooltje</a> die maakt.
    </td>
  </tr>
  <tr>
    <td>
      <strong>camera_scale</strong>
    </td>
    <td>
      camera_scale=1.33
    </td>
    <td>
      verlengt het blikveld. Als je denkt dat mensen het blikveld wat 'kort' getrokken hebben, kan je het met dit getal 'verlengen'.
    </td>
  </tr>
  <tr>
    <td>
      <strong>show_result_centroids</strong>
    </td>
    <td>
      show_result_centroids=true
    </td>
    <td>
      geeft punten voor de panden i.p.v. polygonen
    </td>
  </tr>
  <tr>
    <td>
      <strong>etc</strong>
    </td>
    <td>
      Gebruik de Submit GET knop om de GET parameters en de url te kunnen zien in de browser
    </td>
    <td>
      
    </td>
  </tr>
</table>



<h2>Probeer het zelf</h2>

<form action="api" method="POST" id="testform">
<div class="wrapper">

  <div class="params">

  <label>Camera scale</label><br />

  <select name="camera_scale" id="camera_scale" style="width: 50%;">
    <option value="1">1</option>
    <option value="1.2">1.2</option>
    <option value="1.5">1.5</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="0.5">0.5</option>
  </select>

  <p class="smaller">
    Verlengt het blikveld. Als je denkt dat mensen het blikveld wat 'kort' getrokken hebben, kan je het met dit getal 'verlengen'. Andersom kan ook natuurlijk.
  </p>
  <!--<label>WFS Data source</label>
  <select name="datasource" id="datasource">
    <option value="use_bag_panden">BAG Panden</option>
    <option value="use_kadaster_bebouwing">Kadaster Bebouwing</option>
  </select>
  <br/>-->
  <label>Output</label><br />

  <select name="output" style="width: 50%;">
    <option value="output_adres_punten">Adres Punten</option>
    <option value="output_pand_vlakken">Pand Vlakken</option>
    <option value="output_pand_punten">Pand Punten</option>
  </select>

  <p class="smaller">Wil je punten van BAG adressen, vlakken van BAG panden of de middenpunten van die vlakken?</p>

  <label>Format</label><br />

  <select name="format" style="width: 50%;">
    <option value="format_geojson">GeoJson</option>
    <option value="format_geojson_io">geojson.io</option>
    <option value="format_geojson_html">Geojson in HTML</option>
    <option value="format_qgis">QGIS (alleen lokaal mogelijk)</option>
  </select>

  <p class="smaller">Wil je de kale GeoJson of de resultaten meteen bekijken?</p>

  <input type="checkbox" id="show_cameras" name="show_cameras" checked> <label>Show Camera's</label>

  <p class="smaller">Wil je het blikveld driehoekje als geometrie opgenomen hebben in het resultaat?</p>
  
  <input type="checkbox" id="show_input" name="show_input"> <label>Show input features</label>

  <p class="smaller">Toont alle panden die binnen het driehoekje vallen, waarvan later berekend wordt of ze zichtbaar zijn.</p>

  <input type="checkbox" id="method_vertex" name="method_vertex" checked> <label>Use method 'vertex'</label>
  
  <p class="smaller"></p>

  <input type="checkbox" id="method_beam" name="method_beam" checked> <label>Use method 'beam'</label>
  
  <p class="smaller"></p>

  <!-- TODO <label>Show Debug Information</label><input type="checkbox" id="show_debug" name="show_debug">
  <br/>-->

  <button type="submit" onclick="document.getElementById('testform').method='POST';">Submit POST</button>
  <button type="submit" onclick="document.getElementById('testform').method='GET';">Submit GET</button>

  </div>

  <div class="entry">

  <textarea name="camera_json" rows="34">
{
  "type": "Feature",
  "properties": {
    "angle": 38.876645504061116,
    "bearing": 31.979981482645943,
    "distance": 87.9921646359149
  },
  "geometry": {
    "type": "GeometryCollection",
    "geometries": [
      {
        "type": "Point",
        "coordinates": [
          4.646878838539124,
          52.3969167956431
        ]
      },
      {
        "type": "LineString",
        "coordinates": [
          [
            4.647177386477727,
            52.39773567907421
          ],
          [
            4.647953579015309,
            52.39743995473123
          ]
        ]
      }
    ]
  }
}
  </textarea>
  </div>


</div>

</form>

<h2 id="hoehetwerkt">Hoe het werkt</h2>